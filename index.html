<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Engels â€“ Unit 1 (les 1â€“4)</title>
  <style>
    body {font-family: Arial, sans-serif; text-align:center; margin:40px; background:#f9f9f9;}
    #game-container {border:2px solid #ccc; padding:20px; border-radius:15px; display:none; background:#fff;}
    #mode-selection button, #controls button {
      padding:10px 18px; margin:5px; font-size:16px; cursor:pointer;
      background:#4caf50; color:#fff; border:none; border-radius:5px;
    }
    #mode-selection button:hover, #controls button:hover {background:#45a049;}
    #question {font-size:24px; margin:20px 0;}
    #answer {padding:8px; font-size:18px; width:80%; max-width:300px;}
    #feedback {margin-top:10px; font-weight:bold;}
    #lesson-select label {margin:0 8px;}
    #score {margin-top:10px; font-weight:bold;}
  </style>
</head>
<body>

<h1>Engels â€“ Unit 1</h1>

<div id="mode-selection">
  <p>Kies modus:</p>
  <button onclick="startGame('en-nl')">Engels â†’ Nederlands</button>
  <button onclick="startGame('nl-en')">Nederlands â†’ Engels</button>
  <div id="lesson-select">
    <p>Welke lessen?</p>
    <label><input type="checkbox" value="1" checked> Les 1</label>
    <label><input type="checkbox" value="2" checked> Les 2</label>
    <label><input type="checkbox" value="3" checked> Les 3</label>
    <label><input type="checkbox" value="4" checked> Les 4</label>
  </div>
</div>

<div id="game-container">
  <div id="score"></div>
  <div id="controls">
    <button id="nextBtn" onclick="onNextClick()">Volgende</button>
    <button onclick="stopGame()">Stop</button>
  </div>
  <div id="question"></div>
  <input id="answer" autocomplete="off" placeholder="Typ het antwoord en druk Enter">
  <div id="feedback"></div>
</div>

<div id="summary"></div>

<script>
const WORDS = [
  // Lesson 1
  {lesson:1, en:"mother", nl:"moeder"},
  {lesson:1, en:"father", nl:"vader"},
  {lesson:1, en:"brother", nl:"broer"},
  {lesson:1, en:"sister", nl:"zus"},
  {lesson:1, en:"son", nl:"zoon"},
  {lesson:1, en:"daughter", nl:"dochter"},
  {lesson:1, en:"aunt", nl:"tante"},
  {lesson:1, en:"uncle", nl:"oom"},
  {lesson:1, en:"cousin", nl:"neef/nicht (van oom/tante)"},
  {lesson:1, en:"grandmother", nl:"oma"},
  {lesson:1, en:"grandfather", nl:"opa"},
  {lesson:1, en:"family", nl:"familie/gezin"},

  // Lesson 2
  {lesson:2, en:"family members", nl:"familieleden/gezinsleden"},
  {lesson:2, en:"nephew", nl:"neef (zoon van broer of zus)"},
  {lesson:2, en:"niece", nl:"nicht (dochter van broer of zus)"},
  {lesson:2, en:"husband and wife", nl:"echtgenoot en echtgenote"},
  {lesson:2, en:"spring", nl:"lente"},
  {lesson:2, en:"summer", nl:"zomer"},
  {lesson:2, en:"autumn", nl:"herfst"},
  {lesson:2, en:"winter", nl:"winter"},
  {lesson:2, en:"the months of the year", nl:"de maanden van het jaar"},
  {lesson:2, en:"numbers", nl:"getallen"},

  // Lesson 3
  {lesson:3, en:"holiday", nl:"vakantie"},
  {lesson:3, en:"Austria â€“ Austrian", nl:"Oostenrijk â€“ Oostenrijks"},
  {lesson:3, en:"Germany â€“ German", nl:"Duitsland â€“ Duits"},
  {lesson:3, en:"France â€“ French", nl:"Frankrijk â€“ Frans"},
  {lesson:3, en:"Belgium â€“ Belgian", nl:"BelgiÃ« â€“ Belgisch"},
  {lesson:3, en:"first name", nl:"voornaam"},
  {lesson:3, en:"surname", nl:"achternaam"},
  {lesson:3, en:"the alphabet", nl:"het alfabet"},
  {lesson:3, en:"children", nl:"kinderen"},
  {lesson:3, en:"picture", nl:"plaatje, schilderij, foto"},

  // Lesson 4
  {lesson:4, en:"country", nl:"land"},
  {lesson:4, en:"public holiday", nl:"nationale feestdag"},
  {lesson:4, en:"Kingâ€™s day", nl:"Koningsdag"},
  {lesson:4, en:"Christmas", nl:"Kerstmis"},
  {lesson:4, en:"to have a party", nl:"een feest geven"},
  {lesson:4, en:"the Netherlands â€“ Dutch", nl:"Nederland â€“ Nederlands"},
  {lesson:4, en:"Turkey â€“ Turkish", nl:"Turkije â€“ Turks"},
  {lesson:4, en:"England â€“ English", nl:"Engeland â€“ Engels"},
  {lesson:4, en:"Poland â€“ Polish", nl:"Polen â€“ Pools"},
  {lesson:4, en:"Greece â€“ Greek", nl:"Griekenland â€“ Grieks"},
  {lesson:4, en:"to pretend", nl:"doen alsof"}
];

let mode = "en-nl";
let remaining = [];
let current = null;
let results = [];
let gameActive = false;
let answeredCurrent = false;
let correctCount = 0;
let wrongCount = 0;

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function updateScore() {
  document.getElementById('score').textContent =
    "Goed: " + correctCount + " | Fout: " + wrongCount;
}

function startGame(selectedMode) {
  mode = selectedMode;
  const checkedLessons = Array.from(
    document.querySelectorAll('#lesson-select input:checked')
  ).map(cb => Number(cb.value));

  const poolWords = WORDS.filter(w => checkedLessons.includes(w.lesson));
  if (poolWords.length === 0) {
    alert("Selecteer minstens Ã©Ã©n les.");
    return;
  }

  remaining = shuffle(poolWords.map(w => ({
    word: w,
    question: (mode === "en-nl") ? w.en : w.nl,
    answer: (mode === "en-nl") ? w.nl : w.en
  })));

  results = [];
  correctCount = 0;
  wrongCount = 0;
  updateScore();
  gameActive = true;
  answeredCurrent = false;

  document.getElementById('mode-selection').style.display = 'none';
  document.getElementById('game-container').style.display = 'block';
  document.getElementById('summary').innerHTML = "";
  document.getElementById('feedback').textContent = "";
  document.getElementById('answer').style.display = 'inline-block';
  document.getElementById('nextBtn').style.display = 'inline-block';

  showNext();
  document.getElementById('answer').focus();
}

function stopGame() {
  gameActive = false;
  document.getElementById('game-container').style.display = 'none';
  document.getElementById('mode-selection').style.display = 'block';
}

function showNext() {
  if (!gameActive) return;

  if (remaining.length === 0) {
    endGame();
    return;
  }

  current = remaining.pop();
  document.getElementById('question').textContent = current.question;
  document.getElementById('answer').value = "";
  document.getElementById('feedback').textContent = "";
  answeredCurrent = false;
}

function onNextClick() {
  if (!answeredCurrent) {
    alert("Eerst beantwoorden en op Enter drukken.");
    return;
  }
  showNext();
}

document.getElementById('answer').addEventListener('keydown', e => {
  if (e.key === "Enter") {
    if (!gameActive) return;
    if (!answeredCurrent) {
      checkAnswer();
    } else {
      showNext();
    }
  }
});

function normalize(str) {
  return str.toLowerCase().trim();
}

function checkAnswer() {
  if (!current) return;
  const userRaw = document.getElementById('answer').value;
  const isCorrect = normalize(userRaw) === normalize(current.answer);

  results.push({
    word: current.word,
    question: current.question,
    correctAnswer: current.answer,
    userAnswer: userRaw,
    ok: isCorrect
  });

  if (isCorrect) {
    correctCount++;
  } else {
    wrongCount++;
  }
  updateScore();

  const feedback = document.getElementById('feedback');
  if (isCorrect) {
    feedback.textContent = "Goed! âœ” (" + current.answer + ")";
    feedback.style.color = "green";
  } else {
    feedback.textContent = "Niet goed. Antwoord: " + current.answer;
    feedback.style.color = "red";
  }
  answeredCurrent = true;
}

function endGame() {
  gameActive = false;
  document.getElementById('question').textContent = "Klaar!";
  document.getElementById('answer').style.display = 'none';
  document.getElementById('nextBtn').style.display = 'none';
  document.getElementById('feedback').textContent = "";

  const wrong = results.filter(r => !r.ok);
  const summary = document.getElementById('summary');

  if (wrong.length === 0) {
    summary.innerHTML =
      "<h2>Klaar!</h2><p>Alles goed! ðŸŽ‰</p>" +
      "<p>Goed: " + correctCount + " | Fout: " + wrongCount + "</p>";
  } else {
    let html =
      "<h2>Klaar!</h2>" +
      "<p>Goed: " + correctCount + " | Fout: " + wrongCount + "</p>" +
      "<h3>Deze waren fout:</h3><ul>";
    wrong.forEach(r => {
      html += "<li><strong>" + r.question +
              "</strong> â€“ juist: " + r.correctAnswer +
              " | jouw antwoord: " + (r.userAnswer || "(leeg)") + "</li>";
    });
    html += "</ul><button onclick='repeatWrong()'>Herhaal foute woorden</button>";
    summary.innerHTML = html;
  }
}

function repeatWrong() {
  const wrong = results.filter(r => !r.ok);
  if (wrong.length === 0) {
    alert("Geen foute woorden om te herhalen.");
    return;
  }

  remaining = shuffle(wrong.map(r => ({
    word: r.word,
    question: r.question,
    answer: r.correctAnswer
  })));

  results = [];
  correctCount = 0;
  wrongCount = 0;
  updateScore();
  gameActive = true;
  answeredCurrent = false;

  document.getElementById('summary').innerHTML = "";
  document.getElementById('game-container').style.display = 'block';
  document.getElementById('answer').style.display = 'inline-block';
  document.getElementById('nextBtn').style.display = 'inline-block';

  showNext();
  document.getElementById('answer').focus();
}
</script>
</body>
</html>
